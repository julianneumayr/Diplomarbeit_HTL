import time

import serial
import serial.tools.list_ports
from settings import BAUD_RATE, PID, VID


def turn():
    def find_serial_device(vid, pid):
        for port in serial.tools.list_ports.comports():
            if port.vid == vid and port.pid == pid:
                return port.device
        return None

    found_port = find_serial_device(VID, PID)

    if found_port is None:
        return -1

    else:
        ser = serial.Serial(found_port, BAUD_RATE)

        try:
            time.sleep(2)
            ser.write(bytes("90\n", "utf-8"))
            time.sleep(2)
            ser.write(bytes("0\n", "utf-8"))
            time.sleep(2)
        except Exception:
            return -2
        finally:
            ser.close()
