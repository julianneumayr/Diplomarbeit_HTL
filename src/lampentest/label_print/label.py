import os
import sys

from PIL import Image, ImageDraw, ImageFont


class Label:
    def create_label(self, business_order, article_number, number, quantity, user):
        #define texts and positions
        text1 = business_order
        position1 = (30, 10)
        text2 = f"{str(number).zfill(4)} / {str(quantity).zfill(4)}"
        position2 = (490, 10)
        text3 = article_number
        position3 = (30, 390)
        text4 = user
        position4 = (660, 390)

        # Pfad zur PNG-Datei
        path = os.path.dirname(os.path.abspath(sys.argv[0]))  # noqa: PTH120, PTH100

        # Lade das Bild
        image = Image.open(f'{path}/label_print/vorlage.png')

        # Erstelle ein Zeichen-Objekt
        draw = ImageDraw.Draw(image)

        # Lade eine Schriftart
        font = ImageFont.truetype('arial.ttf', size=70)  # Pfade zur Schriftart ersetzen

        # Schreibe den Text auf das Bild
        draw.text(position1, text1, font=font, fill=(0, 0, 0))  # RGB-Farbe
        draw.text(position2, text2, font=font, fill=(0, 0, 0))  # RGB-Farbe
        draw.text(position3, text3, font=font, fill=(0, 0, 0))  # RGB-Farbe
        draw.text(position4, text4, font=font, fill=(0, 0, 0))  # RGB-Farbe

        # Speichere das bearbeitete Bild
        # https://docs.python.org/3/library/tempfile.html
        image.save(f'{path}/label_print/output.png')

        # Drucke das Bild
        # TODO: pycups
        #os.system("lp -d cab_SQUIX_4_300P output.png")
        