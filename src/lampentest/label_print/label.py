from PIL import Image, ImageDraw, ImageFont

class Label:
    def create_label(self, business_order, article_number, number, quantity, user):
        #define texts and positions
        text1 = business_order
        position1 = (30, 10)
        text2 = f"{str(number).zfill(4)} / {str(quantity).zfill(4)}"
        position2 = (490, 10)
        text3 = article_number
        position3 = (30, 390)
        text4 = user
        position4 = (660, 390)

        # Pfad zur PNG-Datei
        path = 'src/lampentest/label_print/vorlage.png'

        # Lade das Bild
        image = Image.open(path)

        # Erstelle ein Zeichen-Objekt
        draw = ImageDraw.Draw(image)

        # Lade eine Schriftart
        font = ImageFont.truetype('arial.ttf', size=70)  # Pfade zur Schriftart ersetzen

        # Schreibe den Text auf das Bild
        draw.text(position1, text1, font=font, fill=(0, 0, 0))  # RGB-Farbe
        draw.text(position2, text2, font=font, fill=(0, 0, 0))  # RGB-Farbe
        draw.text(position3, text3, font=font, fill=(0, 0, 0))  # RGB-Farbe
        draw.text(position4, text4, font=font, fill=(0, 0, 0))  # RGB-Farbe

        resized_image = image.resize((241,145))

        # Speichere das bearbeitete Bild
        resized_image.save('src/lampentest/label_print/output.png')

        """    os.startfile('output.png')

            time.sleep(3)

            # Simulate pressing "Ctrl + P"
            pyautogui.hotkey('ctrl', 'p')

            time.sleep(8)

            # Simulate pressing "Tab" for 9 times
            for i in range(9):
                pyautogui.press('tab')"""

        """# Simulate pressing up arrow key
            pyautogui.press('up')

            # Simulate pressing "Tab" for 7 times
            for i in range(7):
                pyautogui.press('tab')"""

        """# Simulate pressing "Enter"
            pyautogui.press('enter')

            time.sleep(10)

            # Simulate pressing "Alt + F4"
            pyautogui.hotkey('alt', 'f4')"""
        